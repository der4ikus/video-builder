# ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —á–∞–π–Ω–∏–∫–æ–≤

## üéØ –ß—Ç–æ —ç—Ç–æ?

Fast Video Builder - —ç—Ç–æ API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏–¥–µ–æ —Å –æ–∑–≤—É—á–∫–æ–π –Ω–∞ GPU —Å–µ—Ä–≤–µ—Ä–µ.
–í—ã –∑–∞–≥—Ä—É–∂–∞–µ—Ç–µ —Ç–µ–∫—Å—Ç –∏ –≤–∏–¥–µ–æ, –ø–æ–ª—É—á–∞–µ—Ç–µ –≥–æ—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ —Å –æ–∑–≤—É—á–∫–æ–π.

## üöÄ –ó–∞–ø—É—Å–∫ –∑–∞ 5 –º–∏–Ω—É—Ç

### 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É Vast.ai
```bash
ssh -p –ü–û–†–¢ root@ssh.vast.ai
```

### 2. –°–∫–∞—á–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
```bash
cd /app
# –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∞—Ä—Ö–∏–≤:
wget https://your-server.com/gpu-server.zip
unzip gpu-server.zip

# –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é (—Å–º. SETUP_GUIDE.md)
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
chmod +x scripts/*.sh
./scripts/setup.sh
```

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
./scripts/start.sh
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
python3 scripts/test_api.py
```

## üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

### –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ:
```bash
curl -X POST "http://YOUR_IP:8000/api/v1/video/create" \
  -F "text=–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ." \
  -F "voice=am_santa" \
  -F "speed=0.8" \
  -F "video=@your_video.mp4" \
  -F "bg_audio=@background.mp3" \
  -F "target_duration_minutes=5"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:
```bash
curl "http://YOUR_IP:8000/api/v1/video/JOB_ID/status"
```

### –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
```bash
curl -L "http://YOUR_IP:8000/api/v1/video/JOB_ID/download" -o result.mp4
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
./scripts/monitor.sh

# –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
./scripts/monitor.sh --watch

# –õ–æ–≥–∏
docker-compose logs -f

# GPU —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
watch -n 1 nvidia-smi
```

## üõë –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤
docker-compose up --scale worker=6 -d

# –û—á–∏—Å—Ç–∫–∞
docker system prune -f
```

## üí∞ –≠–∫–æ–Ω–æ–º–∏—è —Å—Ä–µ–¥—Å—Ç–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ—Å—Ç–æ–µ:
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç):
*/5 * * * * /app/scripts/auto_shutdown.sh
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞—Ç—Ä–∞—Ç:
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –±–∞–ª–∞–Ω—Å –≤ –∫–æ–Ω—Å–æ–ª–∏ Vast.ai
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Spot instances –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏
- –í—ã–∫–ª—é—á–∞–π—Ç–µ —Å–µ—Ä–≤–µ—Ä –∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–ª—è RTX 3090 (24GB):
```bash
# –í .env —Ñ–∞–π–ª–µ:
WORKER_REPLICAS=4
GPU_MEMORY_LIMIT=6144
```

### –î–ª—è RTX 4090 (24GB):
```bash
# –í .env —Ñ–∞–π–ª–µ:
WORKER_REPLICAS=6
GPU_MEMORY_LIMIT=4096
```

### –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ (—Å—Ç–∞–±–∏–ª—å–Ω–µ–µ):
```bash
# –í .env —Ñ–∞–π–ª–µ:
WORKER_REPLICAS=2
GPU_MEMORY_LIMIT=8192
```

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "CUDA out of memory":
```bash
# –£–º–µ–Ω—å—à–∏—Ç–µ –≤–æ—Ä–∫–µ—Ä–æ–≤
docker-compose up --scale worker=2 -d
```

### "Port already in use":
```bash
# –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å
lsof -i :8000
kill -9 PID
```

### "No space left":
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ Docker
docker system prune -a -f
# –û—á–∏—Å—Ç–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
rm -rf /tmp/video_jobs/*
```

### API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker-compose ps
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
docker-compose restart api
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: `http://YOUR_IP:8000/docs`
- –õ–æ–≥–∏: `docker-compose logs`
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: `./scripts/monitor.sh`
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `python3 scripts/test_api.py`

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à GPU —Å–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!
API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://YOUR_IP:8000`
